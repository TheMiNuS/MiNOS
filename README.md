# MiNOS (MiNuS OS) ‚Äî ESP32 Native (ESP-IDF 5.5)

**MiNOS** (*MiNuS OS*) is a generic, fully **ESP-IDF native** software framework  
designed as a foundation for modular embedded projects.  

---

## üöÄ Main Features

- üåê **Secure Web Server (HTTPS)** with embedded pages and basic authentication  
- ‚öôÔ∏è **Wi-Fi STA / AP management** with auto-detection and intelligent rollback  
- üíæ **Persistent configuration** stored in NVS  
- ‚è∞ **NTP-based time synchronization**  
- üîÑ **OTA firmware update** via web interface  
- üß© **Class-oriented structure** (`MnWiFi`, `MnWeb`, `MnConfig`, `MnOta`, `MnTime`)  
- üìÑ License: [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/)  
  *(Free to use and modify, commercial use prohibited.)*

---

## üóÇÔ∏è Project Structure

```
MiNOS/
‚îú‚îÄ‚îÄ main/                 ‚Üí Entry point `app_main.cpp`
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ example_demo/     ‚Üí Demo with example on how to tweak Minos
‚îÇ   ‚îú‚îÄ‚îÄ mn_cfg/           ‚Üí Persistent configuration management (NVS)
‚îÇ   ‚îú‚îÄ‚îÄ mn_wifi/          ‚Üí STA/AP management, automatic rollback
‚îÇ   ‚îú‚îÄ‚îÄ mn_web/           ‚Üí HTTPS Web Server, embedded HTML interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ certs/        ‚Üí HTTPS certificates (not versioned)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ htmlCode.h    ‚Üí Embedded HTML/CSS code
‚îÇ   ‚îú‚îÄ‚îÄ mn_ota/           ‚Üí OTA update via `/doUpdate`
‚îÇ   ‚îî‚îÄ‚îÄ mn_time/          ‚Üí NTP synchronization
‚îú‚îÄ‚îÄ partitions.csv        ‚Üí Custom partition table
‚îú‚îÄ‚îÄ sdkconfig.defaults    ‚Üí Default build configuration
‚îú‚îÄ‚îÄ CMakeLists.txt        ‚Üí Global CMake configuration
‚îú‚îÄ‚îÄ LICENSE               ‚Üí CC BY-NC 4.0 license
‚îî‚îÄ‚îÄ README.md             ‚Üí This file
```

---

## üîê Generating HTTPS Certificates

Certificates and private keys are **not included** in the Git repository  
(to prevent key leakage).  

> üìç All paths assume you are in `components/mn_web/certs`.

### 1Ô∏è‚É£ Generate an ECDSA private key (P-256)
```bash
openssl ecparam -genkey -name prime256v1 -noout -out key.pem
```

### 2Ô∏è‚É£ Create a self-signed certificate
```bash
openssl req -new -x509 -key key.pem -out cert.pem -days 365 -subj "/CN=MiNOS"
```

### 3Ô∏è‚É£ Embed the certificates in the firmware
The `mn_web` component‚Äôs CMake configuration automatically embeds them:

```cmake
idf_component_register(
    SRCS "MnWeb.cpp"
    EMBED_TXTFILES "certs/cert.pem" "certs/key.pem"
)
```

---

## üß∞ Build and Flash

```bash
idf.py set-target esp32
idf.py fullclean
idf.py build
idf.py -p /dev/ttyUSB0 flash monitor
```

> ‚ö†Ô∏è If you encounter the error  
> `error in creating ctrl socket (112)`,  
> increase `CONFIG_LWIP_MAX_SOCKETS` and `CONFIG_HTTPD_MAX_OPEN_SOCKETS` in `sdkconfig`.

---

## üåç Usage

1. **First Boot**  
   - The module starts in **AP mode** (`SSID = module MAC address`).  
   - Connect and open [https://192.168.4.1/](https://192.168.4.1/).  
   - Configure your Wi-Fi through the web interface.

2. **STA Connection**  
   - Once connected, the ESP restarts and joins your network.  
   - The assigned IP address is displayed on the serial console.

3. **OTA Update**  
   - Accessible from the *Update firmware* page.  
   - Upload a `.bin` file generated by ESP-IDF.

---

## üß† Philosophy

MiNOS aims to provide a **minimalistic embedded OS foundation**.  
Each `mn_*` component is independent and reusable across other ESP-IDF projects.  

The architecture focuses on **portability**, **stability**, and **security**,  
while remaining simple enough to adapt for derivative products.

---

## ‚öñÔ∏è License

**Creative Commons Attribution-NonCommercial 4.0 International (CC BY-NC 4.0)**  
You may copy, modify, and redistribute this project for non-commercial purposes,  
provided you credit **TheMiNuS** and keep the same license.  

---

¬© 2025 TheMiNuS ‚Äì All rights reserved.
